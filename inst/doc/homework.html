<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Xinrong Xiang" />

<meta name="date" content="2021-12-16" />

<title>Homework</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Xinrong Xiang</h4>
<h4 class="date">2021-12-16</h4>



<p><strong>2021-09-16</strong> ## Question Use knitr to produce at least 3 examples(texts,figures,tables). ## Answer 1.texts</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#print(&#39;Hello World!&#39;)</span></span></code></pre></div>
<p>2.figures</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dosage <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">45</span>, <span class="dv">60</span>) </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>drugA <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">20</span>, <span class="dv">27</span>, <span class="dv">40</span>, <span class="dv">60</span>) </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>drugB <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">41</span>, <span class="dv">50</span> )</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dosage,drugA,<span class="at">type =</span> <span class="st">&#39;b&#39;</span>,<span class="at">pch=</span><span class="dv">15</span>,<span class="at">xlab=</span><span class="st">&quot;Drug Dosage&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Drug Response&quot;</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(dosage, drugB, <span class="at">type=</span><span class="st">&quot;b&quot;</span>,<span class="at">pch=</span><span class="dv">17</span>) </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">title=</span><span class="st">&quot;Drug Type&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>),<span class="at">pch=</span><span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">17</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAbFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6Ojo6OpA6kNtmAABmADpmZjpmkJBmtrZmtv+QOgCQZgCQkGaQtpCQ27aQ2/+2ZgC2tma225C2/7a2///bkDrbkJDb////tmb/25D//7b//9v///9XfT1OAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAL4ElEQVR4nO2dbWObOhKFibd2u0l2b7zdDfe2bPHL//+Pl5EQxjboSMNgSHrOh8auh5F40DsjKM5UVMXSGVi7CAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICA8gCd9oXT5udM2VmfsgBVxbP/UIcPn185gE77Dkv15dcMmVmjcgAdX97Cx/q3qWTGJaj4MFIAOr4UX36VscalKtoiNNoGGXeK1n3shY4CUP303pSL40uMUMPQabQF+sSApP5IxakmtS6fGJC0wAJI1fzmV+1Ev7buTEpQGevAy4beYVcUT+/InY3WBKhtg7p2eEiOz9f3qw5/zJ2JVgXIt8CjZcMZNA14uZWPo918arppWhcgKCk37VhorKVy7kqfi0hRvPSH8WndfFPpWQC50lPhEuSbscNuC9y52mqXuywpAEkFqiJDHGey+emKUD1WE3uAxo2CHguoiHxLOqw5LbnoZfS6175ejNr0AZ322/Px9Xux+SFNumvXm8r39L3j5gG5BKvt4et/m+7R1d/mMrUjdUNARfRrwnFyAnXTbkybhvYByd/jS/P5GABJL1gXN4AkwdP+rRk9+Aycq8bgsHvOOg2Yr1tPOkByAgYj6QCoceU6vgDosJN2u7wBJL82nzySbrLjr5MVoHs/miq2lct9fEFNK3Z3BejtAsifdH0DSOpYJdX7zf/of/dfjQANuFE10k3hl3ZjclauqlgPUDUMqOFWPof61gAqLqMEG0BDXubp5hPd9RvphBJ0fP3f63sPUK/zM8ndoJM1AJIzbdk8uzrjq011C+i0/9Yc4NugUOjscjcyf1YAMrljcTVQDO3zaf/lV+N9pBdr7wUcds3/d71Y25RPBzTmQdNIWywz3041fHGQecUf7Tho82eXTgDk/h52/96105Oqu0yTAY060HTzFndyEtK9H2gd/vkrdFv57pTZ0Y2DpiuarmMwcCGq5/MsgGLLd5oFs2kdfEq69dAk/7BrmyxrQNGDNQtm8fWJXHcmmuIu3jxrqljKAo02V493N8rHV7xFx0ErcDfe/BBQ/Lhw60UDSG5XRNek89xZSOku1nvpAfnbydG7GvFkV3NfDPHR3xcTTQtsWQOg2EET76yKDFYU7aRwFy3El4L+25ag8d5d6dmmDcpPdyZ3I2sb98XqN+3FhtfGVreimKMyGg6a526IxFjHukJAg+OAw9d/xTqFrNwN3LqIDKgVXt1sbGL0ai6gavPX0Cw+wR20jQ/KNI20a36qaY1QJqDTfhtdZskAdNtLgUM13by/ktEAqnR3Az8NAJKLErsk6adRXH+DByoGiq8+n7MNFIcAle7G9HgznXoafbu0+Y6+BM02UBwA1N7qGb8kiafRM0udDapXFOcbKA4Aqno3UXPdDVllTJYnrChOWlTM6pfb9jkSDpDkrjXKW0qYaRwEby5muQs3mceb6QR37QJh7kLLPIDwdqgsd6HDbIOBctwVVx8Uy1AKQDgEL2UzS2q65/6NntFmenxuXnQGulU6BSAcgpewHepBM5cLFO0apm7BDITgGZegBI24M1jc1QFCIXgr2Q5lsfytqWIJIXjr2A61ECC7EDw7rQrQpOQeedvHJK1ZAQ0GYujdRbSuEgT3rCbMRvJWYXwoWvZyx0KAEvastp2XugQNrXZE1+ju3IV5xQKAkvasup0F1oAi1yRzmTBDunFQwp7V0m2k0AG6u+4BUKI7ywZOX4LQkmszYTUGVI2PLIrRL1OlboPwgtlh9w8doPumowTDztadcdeY5/O6F0u6s+piwhXpDgByaGqw/eym2BmN3MwNJ7sbGN+11Xl8UXoAkFGGJwD6/+PCX1pA4x2nuLuBuhSgqh37nfYPjA8KJSg6970GZFXicwHJ8rDksy6mPVtKAygSoF3ctVwLAXKTeNny9tjwl5SpxjUgsyYzE5AbzJ7238b7E+t0U91dN+2LjaT9YDYeq2Obrs7d0oCmP7ltXkCG3nWApu/3ISCrdDXuFpysfghAS05WbSIXctJVuFt6Nv/YdPPd2bomoAzPNoZLu1sqo0arK4+8L/ZYz+s+o08IyFi2uetnNNuw19NPCOM0P6O5QGkW7d1UtS7epjykIiXdvGDL1QAKcR1yZ0M/acXpZp7segD1tmROCLZH6Waf6noA9bZkTnjOWzxdTTTqagBd2qApQVTx+2Iah+sB5PuxpvBMedLSaLrak1wToBnT1ZzhjIOg88oArQ/PpIGi9XqQrmWekIe0JLSGE98ocpeuCs+UHKQmojactu56c/sq/1wfUHh8OmrDaBFK2w6lP8kH0TlPARTfipC0HUrfpasO06WlNYxtRUjczKIbuDyqboXksg3hNozk7VCaod1j6ZxnGgellaDEsW/f7OF4pkxWY0raDpW4GDj3kiFKPtsw6VGlhtuhPhwgm5fOfWJAk6YailX2DwcoSVVY0h8bLf3mgCr3EHb3ohA1oEvP9cEA+SoWXa73HZ08gF0JqE/kowEqw9PSoxvqukcM5QNaksaAcgF172qI7OS5DJXKbR6glcERZQLqrdPHljsClqY6jgO6qTsrhCPKBNS7mRq95xOG0qMbFm4BrRKOKBuQ0UuK0+diC4uAgAgIiICAsgFdZlMEpDNcxN18WgzQh9FCgPKcJtotYqY0t3VKQDZ2BLRGM6W5rVMCsrEjoDWaKc1tnRKQjd3nA/SZREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEZArI7XVxcSJ1/KmwVfgZ2F0etRgx83c9t9CbvAV0m5RoX5aATnt54ZxkQuKx6vFMSIiN+xnYybkIoLjZ4Wv7S9ysdi97w5m7kSUgH53WnL0PRRsNxWqf2rg9A7v2MfvILEQTxM38rzhzt7Jvg5qL05GKmAkgaFd9+U8DCJiFB3bHzbpylpK5nuwBlZufPjPxOBEJKUZ2ze/SBgGz8ptv+eJm9ebHS4LZncwByT4XX8Nj9dw/VBfYSWVwT+CNmvkXEZQo1UrCVqTY4sxdyRpQHdpolAcJtwZ24RH7Ke7kkSNxQE/vKWZ3Mgbk90kllWJpq6J27teEKuaNd29xM9/oQLM72QKq+m8mAe2g5DVq171DM8Vdc9pxM08Emt3JFNAlSjjak/os1kk9bgm7+URvPsowLdG+bMdBIdoajMW6s8ZjthIPFN25ltBblZ5oX5aA2johaVfx0bw8irzdG5I01YibJXqrwzwIJtoXJ6tABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEDLACrbwBYLq5m1ECAXknDYxWNQ0qxm1pKAUBBKmtXMWhSQxFQeX78Xmx8S3eRCnJpq9fS9JdKzugSvSLx84V/+3ta+7pAqxLdYalFA8tcFqR4DIHkzVV1cA/KBnA0MiZN38WTyRcKmXGBmd4gLLN5ZE1oWULX56cLuAyAfTlfeAOrC45vKFoIvj6/vPvquO8Q/TdTkuep9rQDQ2wWQP736HpDH0Px7fLkQqKWOdYf4o2IP61VpBVWsB6gaBNT89ectZm5H0ZtrcDZ/Nf/bHVIXs4wKlm+kYQm67OoIxaNst4PIPzclyFyLd/Mtm+d+4PQ1ILHq2iD3Q0ApjXV3SNJ7L/K17EAxtM+yL6GpO4O9mO+YQi8WtpkJl+OL9OpXvVjXwJtp8amGv/Cya/CPdhy0+bNth6+mGmEcVPcDjR2O7hAZB1l3YqucrCq6avPevdO6ALkGJe9d04pDsrQuQK4CZXbUikNytDJA6xMBAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQ0N8Cz7jKRx1BVQAAAABJRU5ErkJggg==" /><!-- --> 3.tables</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(mtcars))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Mazda RX4</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.620</td>
<td align="right">16.46</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Mazda RX4 Wag</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.875</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Datsun 710</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108</td>
<td align="right">93</td>
<td align="right">3.85</td>
<td align="right">2.320</td>
<td align="right">18.61</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
<td align="right">19.44</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Valiant</td>
<td align="right">18.1</td>
<td align="right">6</td>
<td align="right">225</td>
<td align="right">105</td>
<td align="right">2.76</td>
<td align="right">3.460</td>
<td align="right">20.22</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p><strong>2021-09-23</strong> ## Question Exercises 3.4, 3.11, and 3.20 (pages 94-96, Statistical Computating with R) ## Answer 1: The Rayleigh density is <span class="math inline">\(\frac{x}{\sigma^2}\exp (-\frac{x^2}{2\sigma^2}), x â‰¥ 0,\sigma &gt; 0\)</span>. Develop an algorithm to generate random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution. Generate Rayleigh(<span class="math inline">\(\sigma\)</span>) samples for several choices of <span class="math inline">\(\sigma &gt; 0\)</span> and check that the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma\)</span> (check the histogram).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>rRayleigh<span class="ot">=</span><span class="cf">function</span>(n,sigma){</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>} </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#F(x)=1-e^(-x^2/2*sigma^(1/2)), 0&lt;=x&lt;=1</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>,<span class="at">main =</span><span class="fu">paste</span>(<span class="st">&#39;sigma=&#39;</span>,<span class="fu">as.character</span>(sigma),<span class="at">sep=</span><span class="st">&#39;&#39;</span>)) </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,sigma<span class="sc">*</span><span class="dv">5</span>, .<span class="dv">01</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(y,(y<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rRayleigh</span>(<span class="fl">1e4</span>,i)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAqFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZmZmkLZmtttmtv+QOgCQZgCQZjqQkGaQkLaQttuQtv+Q2/+2ZgC2Zjq2kGa229u22/+2/7a2///T09PbkDrbkGbbtmbbtpDb27bb/9vb////tmb/25D/27b//7b//9v///+LABP6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJVklEQVR4nO2di3abRhRFx6ldu3XSh52kTdSnSZpGyqOSben//6wDAxKSgMMdZphrdPZa8XJkMwN7Xe48DWZDOjGpT0A7FASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEECLoPXMXCy9jnz43ZizX/2O7cGTF/R4a3IuQ59QhRZB3iyMeZN/eRup/MSCPl3b++PHD9sIWr8z5vwuM88+2si4/HJtzt5sPl3Zj/Jf/vLKhsoL++39lXGc3a3fP7fH2Q+mKWjhrvPZx1KQ/Zpf9rUT5Lguf2OzqqTUBRXFrLPqu/AkFZRHyXLz2ZibUpB1cLm0l1sKusl/5u6g4je+LWLl5lDQypQhFoOkguyFnv/jvnWCsiJUrJtCkP3AfS2s5Hx9f92Qj/M4/CnWOSYV5O6ob/I2uhBUNWVVDnIxtikFrX83bQ3Wl8pgeNLmoIdX7k752wlyOloE5TbP//yaf3CYgzZl6MUgdTP/8EeehMvg6YwgF0aPpybIsv7NXl1TDtoXtCr6OodJ+uH1VX5zZb79cEhSQfaaf17m91kVPPut2FEEXSwfZgc5yB5nw6hoCOOQNoLebe+Upn7QcQ5qSNJlNMUKoNS32Oc8A73Y70n/8KG9FTv/a3GYbR5en8RgdY94GUWOLkFZ0eOzARNtcC5Gl6DVYfOdHl2CbEK5Kof3WlAmSB8UBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEkAmq1qZirfMqRCRoUa1frqItZKpDImg922pZ6Fm4ioxE0OPtdiPg6mRuMkYQQJiDyhBiDmqh2np6MvHDfhCEggAyQfmG2yINLdiKNbE4u7NpKN+aQkFNuGZ+PbMpmoKaqDqK2cVykCDzlBKfV0cxuxwgyOzhW8poyHJQqaXYyLxXSu8LLn7FzOfG/rNMTNC2K72etUQQFlR8mVeGpiZocHHu586NoaDjH9cEFYYmK6gtSXcXV6UoJyg3NFlBHsXV2655aYiC6j+a18RUIURBtR9tvdS+mZoguKrRfYsdCZraLYZXNToFzRsEqTcUeE76tAX1WNXozEGNgrQbGjGCGgWpn9IMvKrRXpxpE6TcUOBVDbkg7SE0Wj+oXZBuQ2MJMq2ClIfQaILakrT2EFIgSHcIjSTIdArSbGgsQe0dReXz96kF7b6etCDTLWiueHp6JEEbCuosDgrSO3+/Pa3q8Vh+pYBMiwTNn4Agt7dl6M665qvcrha2C1I7f79/WoMd+QrSu8BxeFqLYfvoJy5oVWwgKzYAhSiu+OBoMaxZkNrJ191p5XM9zsyAXeLHguZ7vcEnLOjxNsRTjaYs6KXzM+yPDPwFqc9BlaBhuw+bBJmegnQaKs8q2+XSsM282RtOPF1BuwgKVNz2g8kIilScRJBKQ7E3L+w2veAkrVjQ4+3N9hnyHUnaY/PCbtNLD0EaDcVeepYIUhlCsTcvTEiQvc3yoWrHOMwrgo723XUJUmhod0rZxfL+6nKTdUybeWxeaNpW1tqKaVzfqI3F3trrfts91JBvXhAIms81br/fE5RZOaGHGiJBCheAarfY5eNt/uaGQY9ynrIge/uc3a1nwx51PVSQvgWgEYYapyNo29lu728PF6RtAWh3Mj0efdP6Z2INxVUfCAWpWyGrJekezRdMUYfX1rg5uluQsvWNWjPfZ6Zs1fwmuNY+nlyQtgWgvX5QwOKq/09H0NAG/qC46v9yQcqmFncn03L3+BZX/n86gvpMmO3o+SeZZkKCohRn5M38XG0zH6M4T0GaDNXOpXgjZTZsh9CUBa3O7hb5aL7LkHRVw1eQIkO1Zv6mmEjtmg+SrmoY3xykUVDeUcwFdcwoiuek9zb/igTpMXQUQVn7rL14VcNbkKIQOsxBi47u4ngRpFKQ6yp27qKSrmr4C9JjSHYislUNM0SQFkMxO4rFhXoKUhNCB2Oxoc8gna6grHyA5MC99mEEaVpjLU9hVSXn+6tBkx5hBJWaVAxb3SnUZsu61ub7Fld+P0yQkun77Qaq6oNwS88ulQwQpGLytRIU6GHsIQXpmJ2OIqj+p7pDBOlJ0qEF7a5ziCAVE0PxBJnhgjTdYnDVXVJcTc1AQekNhTmDg54dBYHiAgpKbki5oPSjeu2Ckg9aowky7ZctE5TYkHpBqQ0pF5R+5kO5oN1XCuoQZCioU1DSubNYgkzHZYsFpZwaktXbc/NCcEEJu9SievtuXggvKN2oTFJv76XnCIKSGZJU23vzQhxBaQxFiiDTfbE+ghJ1qYU5qN/mhTiC0ow6omxeiCIo0aAjUj8ogqBK08g9oicmaPxkHaej2PiOkTCCxlYUp6PY/2J9BG3GTERxmvm4gkbN13E6inEF1UUNuvg+PMUIqn0YP5bCdBQPFw5VE1EQX6dOjqAggKcgvgx7WKGq0SBorINGOIaCgv56jwegeJyD/0HaBOHBqtc5+B+kTFCPoYbXOfgfpExQ772wpyqIEYTAqxpe5+B/kDZBfQerpyvoBKEgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGA8IJW4DFWTbhZAtFTQ+6//yiuzR0jqyy4oPw5Miupofvv5EqLOU1RbeUxsspCC3KzjtJHyIifZrByKyui2spjhJWFFuSePyRdmV5IhZqb4jIltVXHCCsLLqiIX2lEZM+N9OWKTpCsNveLsspCC3IJQZiE8lfC2BMXGSouVlhbcYywMhWCykNFYectSFiZjlvMHSp6fJr/LSarTEeSdoeKml9xkt7sC+pbmYpm3l2nxy0mrK0mNdkt5tdRLC7RI0kLaytbMVFl4YcaC4+hRvEqZdkDHMsQENVWHiOqjINVAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQQLugfPdY7RWV46NdUPWW92RoF7RZPfv3pceW2WCoF7TJZH/kEhr9glbCvXmBUS9oPfsl6SMJ1QtaXPw3S9iIqReUP/Vq2KtfB6JdUGab+Nq7zMdHu6DkUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgP8BbzOR5v/V2BAAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>2.Generate a random sample of size 1000 from a normal location mixture. Thecomponents of the mixture have N(0, 1) and N(3, 1) distributions with mixing probabilities p1 and p2 = 1 - p1. Graph the histogram of the sample with density superimposed, for p1 = 0.75. Repeat with different values for p1 and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of p1 that produce bimoda mixtures.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Mix<span class="ot">&lt;-</span><span class="cf">function</span>(n,p){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>p,p))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> r<span class="sc">*</span>X1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">*</span>X2</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(Z,<span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&#39;p=&#39;</span>,<span class="fu">as.character</span>(p),<span class="at">sep=</span><span class="st">&#39;&#39;</span>))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">Mix</span>(<span class="fl">1e4</span>,<span class="fl">0.75</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)){</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Mix</span>(<span class="fl">1e4</span>,i)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAflBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6OmY6OpA6ZpA6kNtmAABmADpmOjpmkLZmtttmtv+QOgCQZgCQZjqQttuQ2/+2ZgC2Zjq227a22/+2/7a2/9u2///T09PbkDrbkGbbtmbb2//b////tmb/25D/27b//7b//9v///+pW5YYAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAH5ElEQVR4nO2da5viNBiGM+PAqoOrok7XVberlAX+/x+0SSiUgeTpIacmz/1p5oK+off1Nk1zqjgRKyL2D0gdCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCLAEQcdPQjz9vLv8/+2jEOL7z2EKX4Cg41ZIVt3/zVr9//QWpPQFCKrF0x+nr0L8qv9tfT2/nfZr8bKzH+eGlARV4vnP9ur5rr149jpLZJ60QlZKyzmFDh/XK/3lf0L8qLQEdVL6gg4b8ao+vM2YQgU9fz79K6ubnqD2Ty3oRkihl5iqZ+5V3Atq06qrkzyTliDloL69QT0S9K31EyaBUhTUtMlhv8Tkp4H8pCio1lbMlXRIP4kJutRBt7f51sb1Nq/qn2B+UhPU3cX6tBn1i24oaldVSD+pCVK8a+BcHzWUoEtyldgOev77dyF+fP8Yevy01g+rSlAtShYU5JxHQUEACgJQECAlQUlCQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBBgnKDzIGeKneu+GCWoVvMsTnKGyquPH5MiYwQdtxctdcDpA3EZI+iwucx6a4q5yJhBgJF10DmFWAcZkJO7JMXkD9tBEAoCTBDUBFtpkwLjBFVCvO5/2PVv+LkzSlAl55iq7Il8m++mKQaoIEY3FPcfpKDIDUXxRZOcINn6Of53ip9BaQo61V3eaFW9KAFzXpXXCfJf6rjYtb59NcalSKEF+U8kx7EpKGw4YzHJC6oNdzEKChvOWAwFgWIoCBSTqiA4qlG4IDyqUbagAX3SZQsaMKpRtiBmEAKPahQuCI9qlC4odDhjMRQEilmaoGgdZksR5CucsRgKAsVQkCn+GQoyxb8RQ0H38eMJatuAK9sXR4bzhEGQx3toL6bcd2buvKhIgr74y6TbmLMd5S5IK5ox7p65oEboncKmD7znLOi6udyMqRsZCzpsXEwby1nQT9rPvJk/BQgyDSqPDOeJaIKqa4cFb/O3JXZ/dBnkKJwn4reDJkYJ1WG2VEG+wt3HjyTosHntBiws7Wg9M7GJOTafdgYpQWrI0DiRnILOamKNrMZ91HiVj6qW5zD5jf1aCYo1Nh9TUCW3al6dKnO3WdkZJM9czn+2PGroenx1up9Ifh/OE5EFVa0c+6NG66h9pjWvyMxYUHttHTYvu8NmVs90zoJUchy383rucxaUYrj7+BRkiHs7pBpFEN645PI0Yv6WN0EGI0EradxTdtyi72QsyNi06QPr8KwFDVnIbFhK570/KAFBc2/w78I5JgFBlnWWk8K5ZaAgD2ncn93hYPutyII8JNLEYKFXHC5OUKBw17gpCGovspddNW+GUM6Cmqe3Wj7NJzlwmIAguZRH9hNa+4OirThMQJBsKEpBtskL8VYcJiCoy6DK3Gsfcb1YAoLOdVBtaS5GXHGYgiDdVLTNoio8gwYQb8XhQgRFWHFoWJwRQZA+97kbS7kXNMhIAEGVvnrqmXPtsxXUdJXzeex9bBRvHWaJCOr1llnG5geHc0gignpPYKnMch02zhNOkKOttOf/tscjYBR0jfDw3CnoGoGCTIfamoTxBcFB5THhph1qO/fYglIIR0HoUHeCXLZasxTU/Rv5jByHoyDTIUPazEULGnKyFERB5kMoCBxSgqA5HWZFCJoTLitBPsbmcxLkZWw+I0GOR1bHDHktQ5DjsfkxJ7sMQa4zKDtBjsfm/Qty0esRcWzevyAXiRShHTTo8b1oQRNOdimCnDQUMxbkpqGYryBHt/l8BTlqKOYraG4GTZpO50DQrOaQm4biu/4gkTQeBfFl2OQOCgJMFDRvot6S8JJBcSthExPPxa2aIUEjfUpBKQjCG6AMCJqxIPywOiRovoIGPGoMCZqvoMFzYUsVxAxC4FGNIUEzFjT0YbVcQQVCQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAL4EmbdCU/3aht6SxrYFlu1AVOh+LSa+Z9eToMbYI3Lctgrqx79W7kHTmAzZDkSFNu0HE9/34EeQ2tTz8Ud6/52HI7O6x9K0/YzlQFSoDjxtNNiPoPrlN3uf2sM8gQpMB6JC9x+mv33Pi6D2B1m2Y5Q83EBfn4d9PMC8876l0Ob5r83Ulzf6ECQz2i7ocZ+2zg5Ljtg6w22F1nKkc+KW6z4EgQ095Wka62i7IMOBqND6CaemCQ+C1JViE2RKA3iJWQZTrIXqam3i9mwTjjGjXsden6eb3P2c88vajTvtoUratkWfsVCJdj6tqg7fUDTvFmu/zVsORIXqIeFkLjGFUdB+bU4Da0PRdiAqVFZQvXHhMQQXdL4WHmuoLY8a1gNBoerdp+nc5rOCggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBEhcULeKeN6rKeeQuCBNbZux4JklCBow8cUfCxB03MbcU24BgmJeYEsQFPUCW4CguBfYAgTFvcDSFzRxjY47UhdkXpsRiMQFNXButG8SF1SdJ9DHu84SFxQfCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgI8D8T7bU7w1lFYQAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAeFBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6ZpA6kNtmAABmADpmOgBmOjpmkLZmtttmtv+QOgCQZgCQZjqQttuQ29uQ2/+2ZgC2Zjq227a22/+2/7a2/9u2///T09PbkDrbkGbbtmbb////tmb/25D//7b//9v////bBUatAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHlklEQVR4nO2dbXvbJhhGcep4rfcWd1vUZVu1Wbbz///hhJAcOxHcSIB40X2+pLURss4FCHgQEq/EiIj9A1KHggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAuQg6PJNiM0vx7uPDuJxmZNnIKiVIbkTUgsKulKLze+v/wrx9PbRabdKQZV4+PNnIT69KAMdm2dVm+7qVFemVilokHIr6LwXX7ovt9dWqBafflqpoIeX1/9k4bgR1P5TCXr4p0/XiM0fq2ykK9XO3KiQfBDUFqmndd7Fege1rGNvfBBUtW5WLahpC5KhijXyH6sWVCsrukZ6aMpF93Fw0hJ0bYPub/Otmrcis25Bw13slrZE/ao6isqVZK1VTHF3E7sdalDQw9+/CfH55d3nl287NViloHdlJwUoCEBBAAoCpCQoSSgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEmCaoX08ZfR3PdSXwAqeakrgeliY3y6xR1iK+KxITdDlctdTboyllaBIVdN5fH/pr4layRAWxBCHq4blRtkEaznt184hbfhIWlAoUBLgKCt8dmpZ3LfrH1+tE7mLhC9K0Rnrz3DZD8jEbChpD3eYvh7aJpqAxho5itT1S0BjXjmL1SEGjDFra7tC9ILHg8Lo7X6KCrl3py0FTgtYuaOnstKehIF3+PckL0jXSwQXdiUlY0ELZfcyfgkD+FATyT1wQjGpEEhSwF+Y5qhFJ0PdwJcnznPS6BVlENQoW1I6v0H4qay9BNdzUCUc1ihb0ih3BqEbpgpQih7mewgU1Qu0UNj/sVbIgWX2UGYfAe8GCzvu7/S9ds5ufg7FXHFPQj8qP27oND4KMF5uAILfp+GIFvW1v6bZuw+Envp8sHE8UvwR5ym7GoTYXG78fNDMXDxMO7y/2LkNxX76yE+QjO+NcmM7IUoLO+y/DKMJtiW+pglLIjoLQoakLaquZHKq6LT8sWVC1PZ52j6+V0zbEBQuS86lNO5aPNtTIQVDVyjEONUKGfcwRnfiC2rp13m+PagmihqBhH+O1pyCo7QjJVxAY/ISdtE9eECZM2MdqFJGHoDAlyOraUxBk8TRhkLBPNoIqi/t7iLBPLoJkR9pjdhMOyUbQkynd1OwmHJKJIOMNfnp2Ew7JRFA3zvCYnf0hmQiymDC7JtGniiwowEKzSZlpF9jPy64/xKOgAAVp6hpF0FAVLaitQdtjZb7Zaxoql6hGNoKazXMtR/NLBw5zESQHWrXzs4QFC5IdRSlo8RnFXAQNJaiymrX3+DBLLoL6Nqh26y6WLEj1Ax1XURUtKFJ2RQkKEdXIRZAaaJlb6CBRjUwEVf2eHKYFZunPSYcT1AyN82mnv4sFimrkIOhmEGqIza+4BN2MwExDjeSjGgEF2e1v5zWqMSXsnosgy+ws0064dgqioJG0WQmC0/FTsrNMm5GgKNlREEpLQSDtigTNimqEE+QzgFhkCRr+u/QVec6OglBaCgJpKQikpSCQloJA2gIFeYlqWD5/mqMgP1GNORebhyBPc9LlCvIU1ShXEEsQwk9Uo2BBfqIaJQvykt1ygnzMehQtqP8T/IrecOsoTntAN0dBjh1Fh4vNQ5Drbb54QXM7inMGXz4FObXVS5Qgp6vzIKj/M02M8Yp0aDuK76IaImkCCkrmDXUL4rkfVB4UBJgpKPLboRYkSAmK2wjrmHktftXYZBrpWwpKQZDl69RXK8j2deprFWT9Muy1CrJeC7tWQSxBCNvXqa9WkO1gdb2CVggFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoChBKk3wqtm9fWzJY0pi2wTAeik552Ar5nd5xAghrtjMjl0Cqox3+t3IOm0RkyHYhO2rRfGN/3oCeMoG5Tz/Gv1P47o5FZNWOp237GcCA6qcp4XjQ4jKB6+9U8pzZaTqAC3YHopKcf5m9dF0RQ+4PAdoyjG+ir6zDHA/Q77xtO2jz8tZ/78sYQgmSJNgsan9NWpcNQRkyT4aaT1jLSOXPL9RCC4Iaejb6NNgvSHIhOWm9w0dQRQFBXU0yCdMUAVjFDMMV4UtWsmbZn0+NXUPc69rpfbvLh5/Qva9futIcaadMWfdqTSpTzeU318h1F/W6x5tu84UB0UhUSTqaKdWgFnXb6YmDsKJoORCeVDdRNXHgKiwvq68K4htow1DAeCE4qxzAJ3eaLgoIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFARIXNDwFLHTK8ydSFyQonZ8f7ALOQiyWPgSjgwEXQ4x95TLQFDMCpaDoKgVLANBcStYBoLiVrD0Bc18RscfqQvSP5uxEIkLauDa6NAkLqjqF9DHq2eJC4oPBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQE+B8OFBGhNziRlwAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>My conjecture: When p1=0.5, the empirical distribution of the mixture appears to be bimodal</p>
<p>3: A compound Poisson process is a stochastic process <span class="math inline">\(\{X(t), t â‰¥ 0\}\)</span> that can be represented as the random sum <span class="math inline">\(X(t) = \sum_{i=1}^{N(t)} Y_i, t â‰¥ 0\)</span>, where <span class="math inline">\(\{N(t), t â‰¥ 0\}\)</span> is a Poisson process and <span class="math inline">\(Y_1, Y_2,...\)</span> are iid and independent of <span class="math inline">\(\{N(t), t â‰¥ 0\}\)</span>.Write a program to simulate a compound Poisson(Î»)â€“Gamma process (Y has a Gamma distribution). Estimate the mean and the variance of X(10) for several choices of the parameters and compare with the theoretical values. Hint: Show that <span class="math inline">\(E[X(t)]\)</span> = <span class="math inline">\(Î»tE[Y_1]\)</span> and <span class="math inline">\(Var(X(t))=Î»tE[{Y_1}^2 ]\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>pgp<span class="ot">=</span><span class="cf">function</span>(lambda,a,b,t){</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">=</span><span class="fu">rpois</span>(<span class="dv">1</span>,lambda<span class="sc">*</span>t)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="at">length =</span> N)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    y[i]<span class="ot">&lt;-</span><span class="fu">rgamma</span>(<span class="dv">1</span>,a,b)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  Xt<span class="ot">&lt;-</span><span class="fu">sum</span>(y)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Xt)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#lamda=3,alpha=2,beta=3</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>pgpx<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  Z<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="at">length =</span> x)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>x) {</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    Z[i]<span class="ot">&lt;-</span><span class="fu">pgp</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,i)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Z)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>pgp50<span class="ot">&lt;-</span><span class="fu">pgpx</span>(<span class="dv">50</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">50</span>,<span class="dv">1</span>)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m,pgp50,<span class="at">type =</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">xlab=</span><span class="st">&#39;t&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;X(t)&#39;</span>,<span class="at">main =</span> <span class="st">&#39;Smulation of compound Poisson(Î»)â€“Gamma process&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Estimate the mean and the variance of X(10) for</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#several choices of the parameters and compare with the theoretical values.</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>test<span class="ot">&lt;-</span><span class="cf">function</span>(l,a,b){</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="at">length =</span> <span class="dv">10</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>      x1[i]<span class="ot">&lt;-</span><span class="fu">pgp</span>(l,a,b,<span class="dv">10</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>   m1<span class="ot">&lt;-</span><span class="fu">mean</span>(x1)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>   mt1<span class="ot">&lt;-</span>l<span class="sc">*</span><span class="dv">10</span><span class="sc">*</span>(a<span class="sc">/</span>b)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>   v1<span class="ot">&lt;-</span><span class="fu">var</span>(x1)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>   vt1<span class="ot">&lt;-</span>l<span class="sc">*</span><span class="dv">10</span><span class="sc">*</span>(a<span class="sc">/</span>(b<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span>(a<span class="sc">/</span>b)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;empirical mean is &quot;</span>,m1))</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;theoretical mean is&quot;</span>,mt1))</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;empirical variance is &quot;</span>,v1))</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;theoretical variance is&quot;</span>,vt1))</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">#lamda=3,alpha=2,gamma=3,t=10</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="fu">test</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] &quot;empirical mean is  20.2185183968275&quot;
## [1] &quot;theoretical mean is 20&quot;
## [1] &quot;empirical variance is  26.3533051695768&quot;
## [1] &quot;theoretical variance is 20&quot;</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#lamda=4,alpha=5,gamma=6,t=10</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">test</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] &quot;empirical mean is  32.7123431570753&quot;
## [1] &quot;theoretical mean is 33.3333333333333&quot;
## [1] &quot;empirical variance is  26.5969793263627&quot;
## [1] &quot;theoretical variance is 33.3333333333333&quot;</code></pre>
<p><strong>2021-09-30</strong> ## Question Exercises 5.4, 5.9, 5.13 and 5.14 (pages 149-151, Statistical Computating with R)</p>
<p>1.Write a function to compute a Monte Carlo estimate of the Beta(3, 3) cdf, and use the function to estimate F(x) for x = 0.1, 0.2, . . . , 0.9. Compare the estimates with the values returned by the pbeta function in R.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span>;</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>mybetacdf<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span>x)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  theta.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="dv">1</span><span class="sc">/</span><span class="fu">beta</span>(<span class="dv">3</span>,<span class="dv">3</span>))<span class="sc">*</span>t<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>t)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> x</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(theta.hat)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)) {</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">mybetacdf</span>(i),<span class="fu">pbeta</span>(i,<span class="dv">3</span>,<span class="dv">3</span>)))</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 0.008574625 0.008560000
## [1] 0.05808867 0.05792000
## [1] 0.1635283 0.1630800
## [1] 0.3136902 0.3174400
## [1] 0.5006419 0.5000000
## [1] 0.6800563 0.6825600
## [1] 0.8338104 0.8369200
## [1] 0.9335486 0.9420800
## [1] 0.9875856 0.9914400</code></pre>
<p>2.The Rayleigh density is <span class="math inline">\(\frac{x}{\sigma^2}\exp (-\frac{x^2}{2\sigma^2}), x â‰¥ 0,\sigma &gt; 0\)</span>.Implement a function to generate samples from a Rayleigh(Ïƒ) distribution, using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>?</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>MC.Phi <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, <span class="at">R =</span> <span class="dv">10000</span>, <span class="at">antithetic =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>antithetic) v <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>) <span class="cf">else</span> v <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> u</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">c</span>(u, v)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>} </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>MC1 <span class="ot">&lt;-</span> <span class="fu">MC.Phi</span>(<span class="dv">3</span>, <span class="at">R =</span> <span class="dv">1000</span>, <span class="at">anti =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>MC2 <span class="ot">&lt;-</span> <span class="fu">MC.Phi</span>(<span class="dv">3</span>, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;the variance without antithetic variables is &quot;</span>,<span class="fu">var</span>(MC1)))</span></code></pre></div>
<pre><code>## [1] &quot;the variance without antithetic variables is  4.13631468022476&quot;</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;the variance using antithetic variables is &quot;</span>,<span class="fu">var</span>(MC2)))</span></code></pre></div>
<pre><code>## [1] &quot;the variance using antithetic variables is  3.65766349270902&quot;</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>((<span class="fu">var</span>(MC1)<span class="sc">-</span><span class="fu">var</span>(MC2))<span class="sc">/</span>(<span class="fu">var</span>(MC1)))</span></code></pre></div>
<pre><code>## [1] 0.1157192</code></pre>
<p>3.Find two importance functions f1 and f2 that are supported on <span class="math inline">\((1,âˆž)\)</span> and are â€˜closeâ€™ to <span class="math inline">\(g(x)=\frac{x^2}{\sqrt{2\pi}}\exp(-\frac{x^2}{2}), x &gt; 1\)</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math inline">\(\int_{1}^{âˆž} \frac{x^2}{\sqrt{2\pi}}\exp(-\frac{x^2}{2}) {\rm d}x\)</span> by importance sampling? Explain.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  ((x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>((x<span class="dv">-2</span>)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dgamma</span>(x,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m,<span class="dv">2</span>,<span class="dv">1</span>) <span class="co">#using f1</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">sd</span>(fg)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(m,<span class="dv">2</span>,<span class="dv">2</span>) <span class="co">#using f1</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f2</span>(x)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">sd</span>(fg)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(theta.hat,se)</span></code></pre></div>
<pre><code>##                [,1]      [,2]
## theta.hat 0.7351525 0.5096365
## se        4.5317701 0.4846075</code></pre>
<p>f2 can produce the smaller variance in estimating the integration.</p>
<ol start="4" style="list-style-type: decimal">
<li>Obtain a Monte Carlo estimate of <span class="math inline">\(\int_{1}^{âˆž}\frac{x^2}{\sqrt{2\pi}}\exp(-\frac{x^2}{2}) {\rm d}x\)</span> by importance sampling.</li>
</ol>
<p>Answer: Notice that this integration=<span class="math inline">\(\frac{1}{2}-\int_{0}^{1}\frac{x^2}{\sqrt{2\pi}}\exp(-\frac{x^2}{2}) {\rm d}x\)</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span>; k <span class="ot">&lt;-</span> <span class="dv">10</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> M<span class="sc">/</span>k <span class="co">#replicates per stratum</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co">#number of times to repeat the estimation</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>T2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">#odinary</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>est[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">-</span><span class="fu">mean</span>(<span class="fu">g</span>(<span class="fu">runif</span>(M)))</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co">#statified</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co">#jth stratum</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)T2[j]<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">g</span>(<span class="fu">runif</span>(M<span class="sc">/</span>k,(j<span class="dv">-1</span>)<span class="sc">/</span>k,j<span class="sc">/</span>k)))</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>est[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">-</span><span class="fu">mean</span>(T2)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">apply</span>(est,<span class="dv">2</span>,mean),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.4007 0.4006</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">apply</span>(est,<span class="dv">2</span>,sd),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.00076 0.00007</code></pre>
<p><strong>2021-10-14</strong> ## Question Exercises 6.5 and 6.A (page 180-181, Statistical Computating with R) 1. Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>UCL<span class="ot">&lt;-</span>LCL<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  LCL[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df =</span> (n<span class="dv">-1</span>))<span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x))<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  UCL[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df =</span> (n<span class="dv">-1</span>))<span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x))<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(UCL <span class="sc">&gt;</span> <span class="dv">2</span> <span class="sc">&amp;</span> LCL<span class="sc">&lt;</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 918</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(UCL <span class="sc">&gt;</span> <span class="dv">2</span> <span class="sc">&amp;</span> LCL<span class="sc">&lt;</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.918</code></pre>
<p>In this experiment, 91.8% of the intervals contained the population mean, which is close to the 95% coverage under normality. Notice that in example 6.4, when the sampled population is <span class="math inline">\(\chi^2(2)\)</span>, only 77.3% of the intervals for variance contained the population variance, which is far from the 95% coverage under normality(Page 162 example 6.6). So the t-interval is more robust to departures from normality than the interval for variance.</p>
<p>2.Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(\chi^2(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test <span class="math display">\[H_0 : Î¼ = Î¼_0 \qquad vs \qquad H_0 : Î¼ = Î¼_0\]</span>, where <span class="math inline">\(\mu_0\)</span> is the mean of<span class="math inline">\(\chi^2(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co">#number of replicates</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">#chi(1)</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#storage for p-values</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">mu =</span> mu1)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>p1[j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value <span class="co"># t-test p-value</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>p1.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(p1 <span class="sc">&lt;</span> alpha)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Uniform(0,2)</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>mu2<span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#storage for p-values</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">mu =</span> mu2)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>p2[j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value <span class="co"># t-test p-value</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>p2.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(p2 <span class="sc">&lt;</span> alpha)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Exponential(1)</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>mu3<span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#storage for p-values</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">mu =</span> mu3)</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>p3[j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value <span class="co"># t-test p-value</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>p3.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(p3 <span class="sc">&lt;</span> alpha)</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p1.hat,p2.hat,p3.hat))</span></code></pre></div>
<pre><code>## [1] 0.1033 0.0473 0.0827</code></pre>
<p>We can see that the observed Type I error rate in this simulation is 0.1033,0.0473 and 0.0856 when the sampled population is <span class="math inline">\(\chi^2(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1), respectively. When the sampled population is Uniform(0,2), the Estimates of Type I error probability is 0.0504, which is close to the nominal rate <span class="math inline">\(\alpha\)</span> = 0.05.</p>
<p>3.If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level. (1)What is the corresponding hypothesis test problem? (2) What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why? (3) Please provide the least necessary information for hypothesis testing.</p>
<p>Answer: (1) Becuase the power of a test against a fixed alternative <span class="math inline">\(\theta_1\)</span> âˆˆ <span class="math inline">\(\Theta_1\)</span> can be estimated by Monte Carlo methods.So I denote the power of method1 as <span class="math inline">\(\pi_1(\theta_1)\)</span>, the power of method2 as <span class="math inline">\(\pi_2(\theta_1)\)</span> <span class="math display">\[H_0 : \pi_1(\theta_1) = \pi_2(\theta_1) \qquad vs \qquad H_1: \pi_1(\theta_1) \ne\pi_2(\theta_1)\]</span></p>
<p>(2)Two-sample t-test. Let <span class="math inline">\(X_{1i}=1\)</span> if we reject <span class="math inline">\(H_0\)</span> in <span class="math inline">\(i_{th}\)</span> experiment for the methed 1 otherwise <span class="math inline">\(X_{1i}=0\)</span>.Let <span class="math inline">\(X_{2i}=1\)</span> if we reject <span class="math inline">\(H_0\)</span> in <span class="math inline">\(i_{th}\)</span> experiment for the methed 2, otherwise <span class="math inline">\(X_{2i}=0\)</span>. So <span class="math inline">\(\pi_1(\widehat\theta_1)=\frac{\begin{matrix} \sum_{i=1}^n X_{1i} \end{matrix}}{n}\)</span>,<span class="math inline">\(\pi_2(\widehat\theta_1)=\frac{\begin{matrix} \sum_{i=1}^n X_{2i} \end{matrix}}{n}\)</span>,where n=1000. In this question, <span class="math inline">\(\pi_1(\widehat\theta_1)\)</span>=0.651 and <span class="math inline">\(\pi_1(\widehat\theta_1)\)</span>=0.676. We use <span class="math inline">\(\frac{\pi_1(\widehat\theta_1)-\pi_2(\widehat\theta_1)}{se(\pi_1(\widehat\theta_1)-\pi_2(\widehat\theta_1))}\)</span> as the test statistics.When the n is very large, the <span class="math inline">\(\pi_1(\widehat\theta_1)\)</span> and <span class="math inline">\(\pi_2(\widehat\theta_1)\)</span> is Asymptotic normal, so that the statistics is normal.We use Two-sample t-test.</p>
<p>(3)Type1 error <span class="math inline">\(\alpha\)</span>,fixed alternative <span class="math inline">\(\theta_1\)</span>.</p>
<p><strong>2021-10-21</strong> 1. Answer: Reapeat of Example 6.8: <span class="math display">\[H_0 :\beta_{1,d}=0  \qquad vs \qquad H_1:\beta_{1,d}&gt;0.\]</span> Assess the Type I error rate for the skewness test of multivariate normality at <span class="math inline">\(\alpha\)</span> = 0.05 based on the asymptotic distribution of<span class="math inline">\(\frac{nb_{1,d}}{6}\)</span> for sample sizes n = 10, 20, 30, 50, 100, and 500.If the sample size is n[i] then <span class="math inline">\(H_0\)</span> is rejected if <span class="math inline">\(\frac{nb_{1,d}}{6} &gt; cv\)</span>, where cv is the critical value.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">3</span> <span class="co"># set dimension=3</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>cv<span class="ot">&lt;-</span><span class="fu">qchisq</span>(<span class="fl">0.95</span>,d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>) <span class="co">#crit. values for each n</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cv)</span></code></pre></div>
<p>The crit. values for this test is 18.30704.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>sk <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">#computes the sample skewness statistics.</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>Sigma<span class="ot">&lt;-</span><span class="fu">cov</span>(x)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">2</span>, mean)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n[i]) {</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (q <span class="cf">in</span> i<span class="sc">:</span>n[i]) {</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    b<span class="ot">&lt;-</span>b<span class="sc">+</span>((x[p,]<span class="sc">-</span><span class="fu">t</span>(xbar))<span class="sc">%*%</span><span class="fu">solve</span>(Sigma)<span class="sc">%*%</span><span class="fu">t</span>(x[q,]<span class="sc">-</span><span class="fu">t</span>(xbar)))<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span>b<span class="sc">/</span>(n[i]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>( n[i]<span class="sc">*</span>b<span class="sc">/</span><span class="dv">6</span> )</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co">#we are doing length(n) different simulations</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n)) <span class="co">#to store sim. results</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co">#num. repl. each sim.</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#test decisions</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">#generate multivariate normal random vector</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(MASS)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>    Sigma0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    mean0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n[i],mean0,Sigma0)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">#test decision is 1 (reject) or 0</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>     sktests[j] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">sk</span>(x) <span class="sc">&gt;=</span> cv)</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>p[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests) <span class="co">#proportion rejected</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">ncol =</span> <span class="fu">length</span>(n))</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>result[<span class="dv">1</span>,]<span class="ot">&lt;-</span>n</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>result[<span class="dv">2</span>,]<span class="ot">&lt;-</span>p</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(result)[[<span class="dv">1</span>]]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;n&quot;</span>,<span class="st">&quot;estimate&quot;</span>)</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result)</span></code></pre></div>
<p>Reapeat of Example 6.10: We estimate the power of the skewness test for a sequence of alternatives indexed by <span class="math inline">\(\epsilon\)</span> and plot a power curve for the power of the skewness test against this type of alternative.Set the significance level <span class="math inline">\(\alpha\)</span> = 0.1 and the sample size is n = 30.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">1</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, .<span class="dv">15</span>, .<span class="dv">01</span>), <span class="fu">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, .<span class="dv">05</span>))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(epsilon)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>pwr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>sk2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co">#computes the sample skewness statistics.</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>Sigma<span class="ot">&lt;-</span><span class="fu">cov</span>(x)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">2</span>, mean)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (q <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    b<span class="ot">&lt;-</span>b<span class="sc">+</span>((x[p,]<span class="sc">-</span><span class="fu">t</span>(xbar))<span class="sc">%*%</span><span class="fu">solve</span>(Sigma)<span class="sc">%*%</span><span class="fu">t</span>(x[q,]<span class="sc">-</span><span class="fu">t</span>(xbar)))<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span>b<span class="sc">/</span>(n<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>( n<span class="sc">*</span>b<span class="sc">/</span><span class="dv">6</span> )</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>Sigma0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>mean0<span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> epsilon[j]</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,n,d)</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (z <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>e, e))</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>      x[z,]<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(<span class="dv">1</span>,mean0,k<span class="sc">*</span>Sigma0)</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>  sktests[i] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">abs</span>(<span class="fu">sk2</span>(x)) <span class="sc">&gt;=</span> cv)</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>pwr[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests)</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epsilon, pwr, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,<span class="at">xlab =</span> <span class="fu">bquote</span>(epsilon), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> .<span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pwr <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>pwr) <span class="sc">/</span> m) <span class="co">#add standard errors</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">+</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">-</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>The power curve crosses the horizontal line corresponding to <span class="math inline">\(\alpha\)</span> = 0.10 at both endpoints, <span class="math inline">\(\epsilon\)</span> = 0 and <span class="math inline">\(\epsilon\)</span> = 1 where the alternative is normally distributed. For 0 &lt; <span class="math inline">\(\epsilon\)</span> &lt; 1 the empirical power of the test is greater than 0.10 and highest when <span class="math inline">\(\epsilon\)</span> is about 0.15.</p>
<p><strong>2021-10-28</strong> 1.Refer to Exercise 7.6. Efron and Tibshirani discuss the following example [84,Ch. 7]. The five-dimensional scores data have a 5 Ã— 5 covariance matrix <span class="math inline">\(\Sigma\)</span>,with positive eigenvalues <span class="math inline">\(\lambda_1\)</span> &gt; Â· Â· Â· &gt; <span class="math inline">\(\lambda_5\)</span>.In principal components analysis,<span class="math inline">\(\theta=\frac{\lambda_1}{\sum_{j=1}^5\lambda_j}\)</span>measures the proportion of variance explained by the first principal component.Let <span class="math inline">\(\widehat{\lambda}_1\)</span> &gt; Â· Â· Â·&gt;<span class="math inline">\(\widehat{\lambda}_5\)</span> be the eigenvalues of <span class="math inline">\(\widehat{\Sigma}\)</span>, where <span class="math inline">\(\widehat{\Sigma}\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>. Compute the sample estimate <span class="math inline">\(\widehat{\theta}=\frac{\widehat{\lambda_1}}{\sum_{j=1}^5\widehat{\lambda}_j}\)</span> of <span class="math inline">\(\theta\)</span>. Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\widehat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot); <span class="fu">library</span>(bootstrap);<span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>b.comp1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) {</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(x[i,]), <span class="at">symmetric =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> ev<span class="sc">$</span>values</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(lambda)<span class="sc">/</span>(<span class="fu">sum</span>(lambda))</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>scor</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>b.comp1,<span class="at">R=</span><span class="dv">200</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>obj<span class="sc">$</span>t0,<span class="at">bias=</span><span class="fu">mean</span>(obj<span class="sc">$</span>t)<span class="sc">-</span>obj<span class="sc">$</span>t0,</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="at">se=</span><span class="fu">sd</span>(obj<span class="sc">$</span>t)),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## original     bias       se 
##   0.6191  -0.0005   0.0477</code></pre>
<p>The bootstrap estimation of the bias and standard error of <span class="math inline">\(\widehat{\theta}\)</span> are -0.0005 and 0.0477.</p>
<p>2.Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\widehat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Jackknife</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span>obj<span class="sc">$</span>t0</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>theta.jack[i] <span class="ot">&lt;-</span> <span class="fu">b.comp1</span>(x,(<span class="dv">1</span><span class="sc">:</span>n)[<span class="sc">-</span>i])</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">var</span>(theta.jack) <span class="sc">/</span> n)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta.hat,<span class="at">bias.jack=</span>bias.jack,<span class="at">se.jack=</span>se.jack),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##    0.6191    0.0011    0.0496</code></pre>
<p>3.Refer to Exercise 7.7. Compute 95% percentile and BCa confidence intervals for <span class="math inline">\(\widehat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(obj, <span class="at">conf =</span> <span class="fl">0.95</span>, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 200 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = obj, conf = 0.95, type = c(&quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level     Percentile            BCa          
## 95%   ( 0.5191,  0.7092 )   ( 0.5277,  0.7308 )  
## Calculations and Intervals on Original Scale
## Some percentile intervals may be unstable
## Some BCa intervals may be unstable</code></pre>
<p>4.Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and Ï‡2(5) distributions (positive skewness).</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#norm</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>sknorm<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci.basic<span class="ot">&lt;-</span>ci.perc<span class="ot">&lt;-</span>ci.bca<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>b.sk <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) {</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[i])</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  m3 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x[i] <span class="sc">-</span> xbar)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x[i] <span class="sc">-</span> xbar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( m3 <span class="sc">/</span> m2<span class="sc">^</span><span class="fl">1.5</span> )</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>b.sk,<span class="at">R=</span><span class="dv">200</span>)</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  ci<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(obj, <span class="at">conf =</span> <span class="fl">0.95</span>, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  ci.basic[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  ci.perc[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norm =&#39;</span>,<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>sknorm <span class="sc">&amp;</span> ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>sknorm),</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;basic =&#39;</span>,<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>sknorm <span class="sc">&amp;</span> ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>sknorm),</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;perc =&#39;</span>,<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>sknorm <span class="sc">&amp;</span> ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>sknorm))</span></code></pre></div>
<p>For normal distribution,coverage rates of standard normal bootstrap confidence interval, the basic bootstrap confidence interval, and the percentile confidence interval are 0.949,0.947 and 0.949.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The proportion of times that the confidence intervals miss on the left, and </span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norml =&#39;</span>,<span class="fu">mean</span>(sknorm<span class="sc">&lt;=</span>ci.norm[,<span class="dv">1</span>]),</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;basicl =&#39;</span>,<span class="fu">mean</span>(sknorm<span class="sc">&lt;=</span>ci.basic[,<span class="dv">1</span>]),</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;percl =&#39;</span>,<span class="fu">mean</span>(sknorm<span class="sc">&lt;=</span>ci.perc[,<span class="dv">1</span>]))</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co">#The porportion of times that the confidence intervals miss on the right.</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;normr =&#39;</span>,<span class="fu">mean</span>(sknorm<span class="sc">&gt;=</span>ci.norm[,<span class="dv">2</span>]),</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;basicr =&#39;</span>,<span class="fu">mean</span>(sknorm<span class="sc">&gt;=</span>ci.basic[,<span class="dv">2</span>]),</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;percr =&#39;</span>,<span class="fu">mean</span>(sknorm<span class="sc">&gt;=</span>ci.perc[,<span class="dv">2</span>]))</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#chisq(5)=Gamma(5/2,1/2)</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>skchisq5<span class="ot">&lt;-</span>((<span class="dv">2</span><span class="sc">*</span>(<span class="dv">5</span><span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">3</span>)<span class="sc">/</span>((<span class="dv">10</span>)<span class="sc">^</span><span class="fl">1.5</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(<span class="dv">1000</span>,<span class="dv">5</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>b.sk,<span class="at">R=</span><span class="dv">200</span>)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  ci<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(obj, <span class="at">conf =</span> <span class="fl">0.95</span>, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  ci.basic[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  ci.perc[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norm =&#39;</span>,<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>skchisq5 <span class="sc">&amp;</span> ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>skchisq5),</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;basic =&#39;</span>,<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>skchisq5 <span class="sc">&amp;</span> ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>skchisq5),</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;perc =&#39;</span>,<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>skchisq5 <span class="sc">&amp;</span> ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>skchisq5))</span></code></pre></div>
<p>For <span class="math inline">\(\chi^2(5)\)</span> distribution,coverage rates of standard normal bootstrap confidence interval, the basic bootstrap confidence interval, and the percentile confidence interval are 0.866, 0.861, and 0.872.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The proportion of times that the confidence intervals miss on the left, </span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norml =&#39;</span>,<span class="fu">mean</span>(skchisq5<span class="sc">&lt;=</span>ci.norm[,<span class="dv">1</span>]),</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;basicl =&#39;</span>,<span class="fu">mean</span>(skchisq5<span class="sc">&lt;=</span>ci.basic[,<span class="dv">1</span>]),</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;percl =&#39;</span>,<span class="fu">mean</span>(skchisq5<span class="sc">&lt;=</span>ci.perc[,<span class="dv">1</span>]))</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The porportion of times that the confidence intervals miss on the right.</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;normr =&#39;</span>,<span class="fu">mean</span>(skchisq5<span class="sc">&gt;=</span>ci.norm[,<span class="dv">2</span>]),</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;basicr =&#39;</span>,<span class="fu">mean</span>(skchisq5<span class="sc">&gt;=</span>ci.basic[,<span class="dv">2</span>]),</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;percr =&#39;</span>,<span class="fu">mean</span>(skchisq5<span class="sc">&gt;=</span>ci.perc[,<span class="dv">2</span>]))</span></code></pre></div>
<p><strong>2021-11-04</strong> 1.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(chickwts) <span class="co"># chicken weights for various</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;sunflower&quot;</span>])</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>])</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span>;</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>;</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(x);</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R);</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>statistic</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x1, y1,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>statistic</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(t0, reps)) <span class="sc">&gt;=</span> <span class="fu">abs</span>(t0))</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(p,<span class="fu">cor.test</span>(x,y)<span class="sc">$</span>p.value),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.816 0.356</code></pre>
<p>The achieved significance level of the permutation test by Spearman rank correlation test is 0.816.The p-value reported by cor.test on the same samples is 0.356.</p>
<p>2.Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations. (1)Unequal variances and equal expectations.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN) </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co">#n1 = n2 = 50; mu1 = mu2 = c(0,0); </span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e3</span>; </span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">3</span>; p<span class="ot">&lt;-</span><span class="dv">2</span>; </span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">0.3</span>; </span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">50</span>; </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">999</span>; </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2; </span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>Tn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]; n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]; n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(z)) z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> z[ix, ];</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>) </span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  block1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>  block2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block1 <span class="sc">&lt;</span> n1 <span class="sc">+</span> .<span class="dv">5</span>); i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block2 <span class="sc">&gt;</span> n1<span class="fl">+.5</span>)</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  (i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>eqdist.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z,sizes,k){</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>Tn,<span class="at">R=</span>R,</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a><span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> sizes,<span class="at">k=</span>k)</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts<span class="sc">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">statistic=</span>ts[<span class="dv">1</span>],<span class="at">p.value=</span>p.value)</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>   x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>p),<span class="at">ncol=</span>p);</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>   y <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(n2,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="fu">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">2</span>));</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>   z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>   p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value</span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>   p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>   p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span><span class="dv">999</span>)<span class="sc">$</span>p.value</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>;</span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<p>Energy test and Ball test are generally more powerful than nearest NN test.</p>
<p>(2)Unequal variances and unequal expectations</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mu1 = c(0,0);mu2 =c(0,0.5)</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>   x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>p),<span class="at">ncol=</span>p);</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>   y <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(n2,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="fu">rnorm</span>(n2,<span class="fl">0.5</span>,<span class="dv">2</span>));</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>   z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>   p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>   p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>   p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span><span class="dv">999</span>)<span class="sc">$</span>p.value</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>;</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<p>Energy test and Ball test are generally more powerful than nearest NN test.</p>
<p>(3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,n2,p)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>   x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rt</span>(n1<span class="sc">*</span>p,<span class="dv">1</span>),<span class="at">ncol=</span>p);</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n2) {</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">2</span>)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">2</span>,<span class="fl">0.5</span>,<span class="dv">1</span>)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">1</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="fl">-0.3</span>,<span class="fl">0.3</span>))</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    Z <span class="ot">&lt;-</span> r<span class="sc">*</span>X1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">*</span>X2</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    y[j,] <span class="ot">&lt;-</span> Z</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>   z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>   p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>   p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>   p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span><span class="dv">999</span>)<span class="sc">$</span>p.value</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>;</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<p>The three methods peform well.</p>
<p>(4)Unbalanced samples (say, 1 case versus 10 controls)</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>n2<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2; </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>   x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>p),<span class="at">ncol=</span>p);</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>   y <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(n2,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="fu">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">2</span>));</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>   z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>   p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>   p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>   p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span><span class="dv">999</span>)<span class="sc">$</span>p.value</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>;</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<p>Ball test is more powerful than Energy test and nearest NN test. <strong>2021-11-11</strong> 9.1 Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1).</p>
<p>Answer: Target distribution is <span class="math inline">\(t(1)\)</span>. Proposal distribution is <span class="math inline">\(N(X_t,\sigma^2)\)</span>.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>rw.Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma, x0, N) {</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> (<span class="fu">dt</span>(y, n) <span class="sc">/</span> <span class="fu">dt</span>(x[i<span class="dv">-1</span>], n)))</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#degrees of freedom for target Student t dist.</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span><span class="fl">2.5</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>rw<span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(n, sigma, x0, N)</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rw<span class="sc">$</span>k<span class="sc">/</span>N)</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>refline<span class="ot">&lt;-</span><span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),<span class="at">df=</span>n)</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rw<span class="sc">$</span>x,<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">xlab =</span> <span class="fu">bquote</span>(sigma<span class="sc">==</span>.(<span class="fu">round</span>(sigma,<span class="dv">3</span>))),</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;X&quot;</span>,<span class="at">ylim =</span> <span class="fu">range</span>(rw<span class="sc">$</span>x))</span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>refline)</span></code></pre></div>
<p>When <span class="math inline">\(\theta\)</span> = 2, the chain is mixing well and converging to the target distribution.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1001</span> <span class="co">#discard the burnin sample</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> rw<span class="sc">$</span>x[b<span class="sc">:</span>N]</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span><span class="fu">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">qt</span>(a, n) <span class="co">#theoretical quantiles</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>Qrw <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y, a)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">cbind</span>(Q, Qrw), <span class="dv">3</span>)) <span class="co">#not shown</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">round</span>(<span class="fu">cbind</span>(Q, Qrw), <span class="dv">3</span>))</span></code></pre></div>
<p>9.8</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">2</span>;b<span class="ot">&lt;-</span><span class="dv">3</span>;n<span class="ot">&lt;-</span><span class="dv">4</span><span class="co">#the paramater</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>) <span class="co">#initialize</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,y)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(x),</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="at">ylab=</span><span class="fu">bquote</span>(y), <span class="at">ylim=</span><span class="fu">range</span>(X[,<span class="dv">2</span>]))</span></code></pre></div>
<p>3.Use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\widehat{R}\)</span> &lt; 1.2.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(r.hat)</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="co">#9.1</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>normal.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="co">#generates a Metropolis chain for t(1)</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="co">#with Normal(X[t], sigma^2) proposal distribution</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="co">#and starting value X1</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> X1</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> (<span class="fu">dt</span>(y, n) <span class="sc">/</span> <span class="fu">dt</span>(x[i<span class="dv">-1</span>], n))){</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> y </span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>    k<span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span> }</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(x)</span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">2.5</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15000</span> <span class="co">#length of chains</span></span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> <span class="fu">normal.chain</span>(sigma, n, x0[i])}</span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a><span class="co">#trace plot</span></span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>n,X[<span class="dv">1</span>,],<span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span>n,X[<span class="dv">2</span>,],<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span>n,X[<span class="dv">3</span>,],<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span>n,X[<span class="dv">4</span>,],<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="dv">4</span>)  </span></code></pre></div>
<p>The trace show that four chains mix well.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="at">xlab=</span>i, <span class="at">ylab=</span><span class="fu">bquote</span>(psi))</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>    rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p>When n=2000,The value of <span class="math inline">\(\widehat{R}\)</span> is below 1.1 within 2000 iterations. <strong>2021-11-18</strong> 11.3 (a)</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(k,a,d)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  m1<span class="ot">&lt;-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">log</span>(<span class="fu">factorial</span>(k))<span class="sc">-</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>))</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  m2<span class="ot">&lt;-</span><span class="fu">exp</span>((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>)))<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>))</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  m3<span class="ot">&lt;-</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  ((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k)<span class="sc">*</span>m1<span class="sc">*</span>m2<span class="sc">*</span>m3</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(n){</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  sum<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>n) {</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    sum<span class="ot">&lt;-</span>sum<span class="sc">+</span><span class="fu">f</span>(i,a,d)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  sum</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set d=2#</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">ncol =</span> <span class="dv">7</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">300</span>),<span class="dv">0</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>result[<span class="dv">1</span>,]<span class="ot">&lt;-</span>n</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>result[<span class="dv">2</span>,]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">g</span>(<span class="dv">1</span>),<span class="fu">g</span>(<span class="dv">5</span>),<span class="fu">g</span>(<span class="dv">10</span>),<span class="fu">g</span>(<span class="dv">50</span>),<span class="fu">g</span>(<span class="dv">100</span>),<span class="fu">g</span>(<span class="dv">200</span>),<span class="fu">g</span>(<span class="dv">300</span>))</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(result)[[<span class="dv">1</span>]]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;n&quot;</span>,<span class="st">&quot;value&quot;</span>)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">n</td>
<td align="right">1.000000</td>
<td align="right">5.000000</td>
<td align="right">10.000000</td>
<td align="right">50.000000</td>
<td align="right">100.000000</td>
<td align="right">200.000000</td>
<td align="right">300.000000</td>
</tr>
<tr class="even">
<td align="left">value</td>
<td align="right">1.349903</td>
<td align="right">1.529729</td>
<td align="right">1.532165</td>
<td align="right">1.532164</td>
<td align="right">1.532164</td>
<td align="right">1.532164</td>
<td align="right">1.532164</td>
</tr>
</tbody>
</table>
<p>When n is lager than 50, this sum converges to 1.532164.</p>
<p>11.4</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k) {</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(<span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k)<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),k,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">25</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>j<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)){</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  h<span class="ot">&lt;-</span><span class="cf">function</span>(a){</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">g</span>(a,i)<span class="sc">-</span><span class="fu">g</span>(a,i<span class="dv">-1</span>)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(h,<span class="at">lower =</span><span class="fl">0.01</span>,<span class="at">upper =</span> <span class="fu">sqrt</span>(i)<span class="sc">-</span><span class="fl">0.01</span>)</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  j<span class="ot">&lt;-</span>j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  Z[j,<span class="dv">1</span>]<span class="ot">&lt;-</span>res<span class="sc">$</span>root</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>  Z[j,<span class="dv">2</span>]<span class="ot">&lt;-</span>res<span class="sc">$</span>f.root</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  Z[j,<span class="dv">3</span>]<span class="ot">&lt;-</span>res<span class="sc">$</span>iter</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">25</span>,<span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>result[,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>result[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]<span class="ot">&lt;-</span>Z</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(result)[[<span class="dv">2</span>]]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;k&quot;</span>,<span class="st">&quot;root&quot;</span>,<span class="st">&quot;f.root&quot;</span>,<span class="st">&quot;iter&quot;</span>)</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right">root</th>
<th align="right">f.root</th>
<th align="right">iter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">1.492073</td>
<td align="right">-8e-07</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1.533555</td>
<td align="right">-1e-07</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1.562745</td>
<td align="right">0e+00</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1.584429</td>
<td align="right">0e+00</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">1.601185</td>
<td align="right">0e+00</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">1.614516</td>
<td align="right">0e+00</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">1.625389</td>
<td align="right">0e+00</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">1.634418</td>
<td align="right">0e+00</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">1.642026</td>
<td align="right">0e+00</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">1.648552</td>
<td align="right">0e+00</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">1.654175</td>
<td align="right">0e+00</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">1.659099</td>
<td align="right">0e+00</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">1.663453</td>
<td align="right">0e+00</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">1.667288</td>
<td align="right">0e+00</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">1.670733</td>
<td align="right">0e+00</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">1.673832</td>
<td align="right">0e+00</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">1.676605</td>
<td align="right">0e+00</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">1.679148</td>
<td align="right">0e+00</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="right">1.681468</td>
<td align="right">0e+00</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="right">1.683593</td>
<td align="right">0e+00</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">1.685546</td>
<td align="right">0e+00</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">1.687366</td>
<td align="right">0e+00</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">1.720607</td>
<td align="right">0e+00</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">22.350680</td>
<td align="right">0e+00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">31.612777</td>
<td align="right">0e+00</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>11.5</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k) {</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  f<span class="ot">&lt;-</span><span class="cf">function</span>(u){</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span><span class="sc">+</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(k<span class="dv">-1</span>))<span class="sc">^</span>(<span class="sc">-</span>k<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  c<span class="ot">&lt;-</span><span class="fu">sqrt</span>(((a<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>k)<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">&lt;-</span><span class="fu">exp</span>(<span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(pi<span class="sc">*</span>(k))<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  it<span class="ot">&lt;-</span><span class="fu">integrate</span>(f,<span class="at">lower =</span> <span class="dv">0</span>,<span class="at">upper =</span> c)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  d<span class="sc">*</span>it<span class="sc">$</span>value</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">25</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>j<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)){</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>  h<span class="ot">&lt;-</span><span class="cf">function</span>(a){</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">g</span>(a,i)<span class="sc">-</span><span class="fu">g</span>(a,i<span class="dv">-1</span>)</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(h,<span class="at">lower =</span><span class="fl">0.01</span>,<span class="at">upper =</span> <span class="fu">sqrt</span>(i)<span class="sc">-</span><span class="fl">0.01</span>)</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  j<span class="ot">&lt;-</span>j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>  Z[j,<span class="dv">1</span>]<span class="ot">&lt;-</span>res<span class="sc">$</span>root</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  Z[j,<span class="dv">2</span>]<span class="ot">&lt;-</span>res<span class="sc">$</span>f.root</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  Z[j,<span class="dv">3</span>]<span class="ot">&lt;-</span>res<span class="sc">$</span>iter</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">25</span>,<span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>result[,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>result[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]<span class="ot">&lt;-</span>Z</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(result)[[<span class="dv">2</span>]]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;k&quot;</span>,<span class="st">&quot;root&quot;</span>,<span class="st">&quot;f.root&quot;</span>,<span class="st">&quot;iter&quot;</span>)</span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right">root</th>
<th align="right">f.root</th>
<th align="right">iter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">1.574339</td>
<td align="right">0e+00</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1.604418</td>
<td align="right">-1e-07</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1.625550</td>
<td align="right">0e+00</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1.641042</td>
<td align="right">0e+00</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">1.652796</td>
<td align="right">0e+00</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">1.661988</td>
<td align="right">0e+00</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">1.669331</td>
<td align="right">0e+00</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">1.675346</td>
<td align="right">0e+00</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">1.680361</td>
<td align="right">-1e-07</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">1.684538</td>
<td align="right">0e+00</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">1.688136</td>
<td align="right">0e+00</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">1.691219</td>
<td align="right">0e+00</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">1.693915</td>
<td align="right">0e+00</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">1.696295</td>
<td align="right">0e+00</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">1.698385</td>
<td align="right">0e+00</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">1.700247</td>
<td align="right">0e+00</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">1.701922</td>
<td align="right">0e+00</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">1.703404</td>
<td align="right">0e+00</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="right">1.704793</td>
<td align="right">0e+00</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="right">1.706048</td>
<td align="right">0e+00</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">1.707150</td>
<td align="right">0e+00</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">1.708219</td>
<td align="right">0e+00</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">1.726325</td>
<td align="right">0e+00</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">1.730920</td>
<td align="right">0e+00</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">1.731487</td>
<td align="right">0e+00</td>
<td align="right">13</td>
</tr>
</tbody>
</table>
<p>The difference between the root decreases as k increases. The root is approximately 1.73 When k= 100, 500, 1000.Compared to 11.4,the result is similar except when k= 500 and 1000,</p>
<p>2.Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare result with the observed data MLE.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compute MLE of lambda</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>, <span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="fl">0.91</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>,<span class="fl">1.00</span>,<span class="fl">1.00</span>,<span class="fl">1.00</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>mlogL <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">lambda=</span><span class="dv">1</span>) {</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># minus log-likelihood</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="sc">-</span>(<span class="fu">length</span>(y)<span class="sc">*</span><span class="fu">log</span>(lambda)<span class="sc">-</span>lambda<span class="sc">*</span><span class="fu">sum</span>(y)))</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats4)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">mle</span>(mlogL)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(y),fit<span class="sc">@</span>coef,<span class="fu">sqrt</span>(fit<span class="sc">@</span>vcov)))</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(imager)</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>imgjpg<span class="ot">&lt;-</span><span class="fu">load.image</span>(<span class="st">&quot;E:/ç ”ä¸€ä¸Š/ç»Ÿè®¡è®¡ç®—/ä½œä¸š/11-18.jpg&quot;</span>)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(imgjpg,<span class="at">axes=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p>The EM estimator is the same as the MLE based on observed data. <strong>2021-11-25</strong> 11.1.2.1</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>trims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="fu">mean</span>(x, <span class="at">trim =</span> trim))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.2477338
## 
## [[2]]
## [1] -0.03374725
## 
## [[3]]
## [1] 0.004143961
## 
## [[4]]
## [1] 0.1027831</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, mean, <span class="at">x =</span> x)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.2477338
## 
## [[2]]
## [1] -0.03374725
## 
## [[3]]
## [1] 0.004143961
## 
## [[4]]
## [1] 0.1027831</code></pre>
<p>è¿™ä¸¤è¡Œä»£ç éƒ½è¡¨ç¤ºæŠŠåˆ†åˆ«æŠŠxä¸¤ç«¯çš„0%, 10%,20%, 50%çš„æ•°æ®è£å‰ªåŽå†è®¡ç®—å¹³å‡å€¼ï¼Œè¿”å›žé•¿åº¦ä¸º4çš„åˆ—è¡¨ã€‚</p>
<p>11.1.2.5</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#11.1.2.3</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="co">#lapply()</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">lapply</span>(formulas, <span class="cf">function</span>(x) <span class="fu">lm</span>(x,<span class="at">data =</span> mtcars))</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(result,<span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared))</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#11.1.2.4</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>mtcars[rows, ]</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">lapply</span>(bootstraps, <span class="cf">function</span>(x) <span class="fu">lm</span>(mpg <span class="sc">~</span> disp,<span class="at">data =</span> x))</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(result,<span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared))</span></code></pre></div>
<pre><code>##  [1] 0.6497636 0.6820834 0.7530595 0.6101709 0.7226119 0.7533418 0.7311415
##  [8] 0.6293502 0.6554375 0.7238971</code></pre>
<p>11.2.5.1 (a)</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Use vapply() to: a) Compute the standard deviation of every column in a numeric data frame.</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">3</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">data.frame</span>(x,y,z)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(d, sd, <span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        x        y        z 
## 1.280755 1.740064 2.397784</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the standard deviation of every numeric column in a mixed data frame. (Hint: youâ€™ll need to use vapply() twice.)</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="at">y=</span><span class="dv">21</span><span class="sc">:</span><span class="dv">30</span>, <span class="at">z =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">vapply</span>(d, <span class="cf">function</span>(x) <span class="fu">is.numeric</span>(x) ,<span class="at">FUN.VALUE =</span> <span class="fu">logical</span>(<span class="dv">1</span>) )</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(d[,a], <span class="cf">function</span>(x) <span class="fu">sd</span>(x), <span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##       x       y 
## 3.02765 3.02765</code></pre>
<p>11.2.5.7. Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not? <strong>2021-12-02</strong> 1.Write an Rcpp function for Exercise 9.8 (page 278, Statistical Computing with R). 2.Compare the corresponding generated random numbers with pure R language using the function â€œqqplotâ€ 3.Compare the computation time of the two functions with the function â€œmicrobenchmarkâ€. 4.Comments your results</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co">#write Rcpp function</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39; NumericMatrix gibbsC(int N,int n,int a,int b) {</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="st">      NumericMatrix X(N,2);</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="st">     X(0,0)=0.2;</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="st">     X(0,1)=0.3;</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="st">     for(int i = 1; i &lt; N; i++) {</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="st">      double y = X(i-1, 1);</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="st">      X(i, 0) = rbinom(1,n,y)[0];</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="st">      double x = X(i, 0);</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="st">      X(i, 1) = rbeta(1,x+a,n-x+b)[0];</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="st">      return X;</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="st">    }&#39;</span>)</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a><span class="co">#R function</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>gibbsR<span class="ot">&lt;-</span><span class="cf">function</span>(N,n,a,b){</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>) <span class="co">#initialize</span></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>   y <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>   X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,y)</span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>   x <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>   X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>  X</span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">2</span>;b<span class="ot">&lt;-</span><span class="dv">3</span>;n<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a>gibbsr<span class="ot">=</span><span class="fu">gibbsR</span>(N,n,a,b)</span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a>gibbsc<span class="ot">=</span><span class="fu">gibbsC</span>(N,n,a,b)</span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(gibbsr[,<span class="dv">1</span>],gibbsc[,<span class="dv">1</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(gibbsr[,<span class="dv">2</span>],gibbsc[,<span class="dv">2</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbsr=</span><span class="fu">gibbsR</span>(N,n,a,b),</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="at">gibbsc=</span><span class="fu">gibbsC</span>(N,n,a,b))</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##     expr      lq  median      uq
## 1 gibbsr 3905.60 4230.35 4458.55
## 2 gibbsc  325.65  334.65  367.55</code></pre>
<p>By qqplot, we can see that the generated random numbers by C++ and R are coincident.The computation time of gibbsC is much less than gibbsR.</p>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
